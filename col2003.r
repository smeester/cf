setClass(Class="col2003",
         representation=representation(endAge="numeric", startAge="numeric"),contains=c("data.frame"))

if(!isGeneric("getQx")){
    setGeneric(
        name= "getQx",
        def=function(object, sex="character", age="numeric"){standardGeneric("getQx")}
    )
    lockBinding("getQx",.GlobalEnv)
}

setMethod(f="getQx",
          signature = "col2003",
          definition=function(object, sex="character", age="numeric"){
              if(!(sex %in% c("M","F"))){
                  cat("~~~~ sex muste be either M or F~~~~\n")
                  return(NULL)
              }
              if(!missing(age)){
                  age <- floor(age)
                  if(age > object@endAge){return(1)}
                  if( age < object@startAge){return(NaN)}
              }

              if(missing(age)){
                  df <- data.frame(subset(object,select=grepl(paste("^",sex,sep=""),colnames(object))))
                  rownames(df) <- rownames(object)
                  return(df)
              }
              if(sex =="M"){
                  return(object[age+1,1])
              } else {
                  return(object[age+1,2])
              }
          })

setMethod(
    f="initialize",
    signature="col2003",
    definition=function(.Object){
        cat("~~~ COL 2003: initializator ~~~ \n")

        .Object@startAge <- 0
        .Object@endAge <- 120

        as(.Object,"data.frame") <- as.data.frame(matrix(data=c(0.0000466000, 0.0000466022, 0.0000466043, 0.0000466065, 0.0000466087, 0.0000466109, 0.0000466130, 0.0000465152, 0.0000466174, 0.0000466195, 0.0000466217, 0.0000466239, 0.0000465260, 0.0000605367, 0.0000738492, 0.0000918680, 0.0001122934, 0.0001340265, 0.0001552673, 0.0001757166, 0.0001918702, 0.0002034255, 0.0002118820, 0.0002173378, 0.0002198907, 0.0002204403, 0.0002203886, 0.0002204372, 0.0002260030, 0.0002394989, 0.0002575205, 0.0002809764, 0.0003097734, 0.0003410070, 0.0003724726, 0.0004039722, 0.0004362129, 0.0004759391, 0.0005224638, 0.0005757055, 0.0006377014, 0.0007108016, 0.0007925274, 0.0008824176, 0.0009827449, 0.0010985319, 0.0012221809, 0.0013816552, 0.0015868474, 0.0018143302, 0.0020454427, 0.0022635217, 0.0025086099, 0.0028286169, 0.0031849712, 0.0035957796, 0.0041213479, 0.0047478643, 0.0054773498, 0.0061680190, 0.0068889809, 0.0077869636, 0.0088230772, 0.0099649699, 0.0111959645, 0.0126759989, 0.0142215903, 0.0157207166, 0.0174901588, 0.0195863252, 0.0220542832, 0.0247933905, 0.0282008156, 0.0319782206, 0.0363177941, 0.0413718480, 0.0468785784, 0.0528042527, 0.0591442605, 0.0660593694, 0.0742173340, 0.0833360895, 0.0918541131, 0.1017093971, 0.1125826054, 0.1239204839, 0.1366130026, 0.1512757639, 0.1671243106, 0.1815246725, 0.1943699705, 0.2118022541, 0.2308264681, 0.2481009742, 0.2721229954, 0.2858367379, 0.3061670176, 0.3269290807, 0.3455350082, 0.3580341582, 0.3679733594, 0.3879216540, 0.4225964912, 0.4743963701, 0.5447818714, 0.6352861497, 0.7409470752, 0.8494623656, 0.9523809524, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000516000, 0.0000516027, 0.0000516053, 0.0000516080, 0.0000516107, 0.0000516133, 0.0000515159, 0.0000516186, 0.0000516213, 0.0000516240, 0.0000516266, 0.0000582330, 0.0000645404, 0.0000715494, 0.0000794605, 0.0000878739, 0.0000958891, 0.0001018043, 0.0001041173, 0.0001046287, 0.0001045395, 0.0001046506, 0.0001045614, 0.0001072768, 0.0001147013, 0.0001264364, 0.0001410816, 0.0001556326, 0.0001694885, 0.0001835518, 0.0001974220, 0.0002130052, 0.0002339143, 0.0002613590, 0.0002951470, 0.0003340833, 0.0003772748, 0.0004263398, 0.0004809926, 0.0005419552, 0.0006113632, 0.0006891481, 0.0007761537, 0.0008724271, 0.0009744926, 0.0010851275, 0.0012076361, 0.0013210571, 0.0014761688, 0.0016408753, 0.0018284283, 0.0020240012, 0.0022469525, 0.0023690481, 0.0024465591, 0.0026999947, 0.0029666449, 0.0032997851, 0.0037222925, 0.0041689975, 0.0047089861, 0.0053250766, 0.0060759292, 0.0066349789, 0.0077440942, 0.0087608987, 0.0097376819, 0.0109589619, 0.0119058247, 0.0128714004, 0.0140433987, 0.0148970408, 0.0162492492, 0.0180496882, 0.0200875091, 0.0225614880, 0.0256688685, 0.0285302624, 0.0319100187, 0.0359655879, 0.0401893009, 0.0470028492, 0.0536453897, 0.0614935138, 0.0709959686, 0.0817810824, 0.0933832969, 0.1066908147, 0.1235085057, 0.1384369174, 0.1585969098, 0.1763003258, 0.1947610614, 0.2146958522, 0.2374185141, 0.2566866845, 0.2759423780, 0.2996819198, 0.3213441559, 0.3510877868, 0.3581239327, 0.3732825298, 0.3995027063, 0.4381296236, 0.4907432372, 0.5587223154, 0.6418716257, 0.7364600782, 0.8347457627, 0.9230769231, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000), ncol=2, nrow=121), row.names=as.character(c(0:120)))
        colnames(.Object) <- c("M","F")
        return(.Object)
    })
